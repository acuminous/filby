{{#if hooks}}-- Drop Projections{{/if}}
{{#projections}}
DO $$
DECLARE
  v_projection_id INTEGER;
BEGIN
  SELECT id INTO v_projection_id
  FROM fby_projection
  WHERE name = '{{name}}'
    AND version = {{version}};

  IF v_projection_id IS NULL THEN
    RAISE EXCEPTION 'Projection {{name}} v{{version}} does not exist';
  END IF;

  DELETE FROM fby_projection
  WHERE id = v_projection_id;
END;
$$ LANGUAGE plpgsql;

{{/projections}}